<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>🧪 바인딩 테스트 시스템</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; }
        .test-card { background: #f8f9fa; border: 1px solid #dee2e6; padding: 20px; margin: 15px 0; border-radius: 8px; }
        .form-group { margin: 15px 0; }
        label { display: block; font-weight: bold; margin-bottom: 5px; }
        input, select { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        .btn { padding: 12px 24px; margin: 5px; border: none; border-radius: 4px; cursor: pointer; text-decoration: none; display: inline-block; }
        .btn-primary { background: #007bff; color: white; }
        .btn-danger { background: #dc3545; color: white; }
        .btn-warning { background: #ffc107; color: black; }
        .btn-success { background: #28a745; color: white; }
        .scenario-buttons { display: flex; flex-wrap: wrap; gap: 10px; margin: 15px 0; }
        .example { background: #e7f3ff; padding: 10px; border-radius: 4px; margin: 5px 0; font-family: monospace; }
    </style>
</head>
<body>
    <div class="container">
        <h1>🧪 @ModelAttribute 바인딩 테스트 시스템</h1>

        <div class="test-card">
            <h2>🎯 테스트 목적</h2>
            <p>@ModelAttribute의 바인딩 과정을 단계별로 확인하고, 다양한 에러 상황을 체험해보세요!</p>

            <h3>📚 학습 내용:</h3>
            <ul>
                <li>HTTP 파라미터 → 객체 변환 과정</li>
                <li>타입 변환 메커니즘</li>
                <li>바인딩 에러 처리</li>
                <li>BindingResult 활용법</li>
            </ul>
        </div>

        <!-- 메인 테스트 폼 -->
        <div class="test-card">
            <h2>🔬 바인딩 테스트 폼</h2>

            <form id="testForm" method="post">
                <!-- 캐릭터 이름 -->
                <div class="form-group">
                    <label for="name">📝 캐릭터 이름</label>
                    <input type="text" id="name" name="name" placeholder="테스트캐릭터">
                    <div class="example">예시: "슈퍼맨", "홍길동"</div>
                </div>

                <!-- 직업 -->
                <div class="form-group">
                    <label for="job">⚔️ 직업</label>
                    <select id="job" name="job">
                        <option value="">선택하세요</option>
                        <option value="warrior">전사</option>
                        <option value="mage">마법사</option>
                        <option value="archer">궁수</option>
                        <option value="thief">도적</option>
                    </select>
                </div>

                <!-- 레벨 -->
                <div class="form-group">
                    <label for="level">📊 레벨</label>
                    <input type="text" id="level" name="level" placeholder="1-100">
                    <div class="example">정상: "25", "50" | 에러: "이십오", "abc"</div>
                </div>

                <!-- 체력 -->
                <div class="form-group">
                    <label for="health">❤️ 체력</label>
                    <input type="text" id="health" name="health" placeholder="1-999">
                    <div class="example">정상: "100", "50" | 에러: "많이", "@@"</div>
                </div>

                <!-- 마나 -->
                <div class="form-group">
                    <label for="mana">💙 마나</label>
                    <input type="text" id="mana" name="mana" placeholder="0-999">
                    <div class="example">정상: "30", "0" | 에러: "무한", "***"</div>
                </div>

                <!-- 프리미엄 -->
                <div class="form-group">
                    <label>
                        <input type="checkbox" name="premium" value="true"> 💎 프리미엄 계정
                    </label>
                </div>

                <!-- 성별 -->
                <div class="form-group">
                    <label>👤 성별</label>
                    <label><input type="radio" name="gender" value="male"> 남성</label>
                    <label><input type="radio" name="gender" value="female"> 여성</label>
                </div>

                <!-- 스킬 -->
                <div class="form-group">
                    <label>🎯 스킬 (다중선택)</label>
                    <label><input type="checkbox" name="skills" value="attack"> 공격력 강화</label>
                    <label><input type="checkbox" name="skills" value="defense"> 방어력 강화</label>
                    <label><input type="checkbox" name="skills" value="speed"> 속도 강화</label>
                    <label><input type="checkbox" name="skills" value="magic"> 마법력 강화</label>
                </div>
            </form>
        </div>

        <!-- 테스트 버튼들 -->
        <div class="test-card">
            <h2>🎲 테스트 시나리오</h2>

            <div class="scenario-buttons">
                <button class="btn btn-primary" onclick="submitTest('step-by-step')">
                    🔬 단계별 과정 분석
                </button>

                <button class="btn btn-success" onclick="setNormalData(); submitTest('step-by-step')">
                    ✅ 정상 데이터 테스트
                </button>

                <button class="btn btn-danger" onclick="setErrorData1(); submitTest('error-scenarios', 'type-mismatch')">
                    ❌ 타입 변환 에러
                </button>

                <button class="btn btn-danger" onclick="setErrorData2(); submitTest('error-scenarios', 'special-chars')">
                    🔣 특수문자 에러
                </button>

                <button class="btn btn-warning" onclick="setEmptyData(); submitTest('error-scenarios', 'empty-fields')">
                    🈳 빈 값 테스트
                </button>
            </div>
        </div>

        <!-- 학습 가이드 -->
        <div class="test-card">
            <h2>📖 학습 가이드</h2>

            <h3>🔍 관찰 포인트:</h3>
            <ol>
                <li><strong>콘솔 로그 확인:</strong> 브라우저 개발자 도구(F12)에서 바인딩 과정 로그 관찰</li>
                <li><strong>에러 처리:</strong> 잘못된 데이터 입력시 애플리케이션이 어떻게 반응하는지 확인</li>
                <li><strong>부분 성공:</strong> 일부 필드만 실패해도 나머지는 정상 처리되는지 확인</li>
                <li><strong>타입 변환:</strong> 문자열이 어떻게 숫자, 불린 등으로 변환되는지 관찰</li>
            </ol>

            <h3>💡 핵심 개념:</h3>
            <ul>
                <li><strong>자동 바인딩:</strong> Spring이 HTTP 파라미터를 자동으로 객체에 매핑</li>
                <li><strong>타입 안전성:</strong> 변환 실패시 기본값 사용, 애플리케이션 중단 안됨</li>
                <li><strong>에러 수집:</strong> BindingResult에 모든 에러 정보 저장</li>
                <li><strong>유연한 처리:</strong> 개발자가 에러를 적절히 처리할 수 있음</li>
            </ul>
        </div>
    </div>

    <script>
        function submitTest(action, scenario = '') {
            const form = document.getElementById('testForm');
            form.action = '/binding-test/' + action;

            if (scenario) {
                // 시나리오 파라미터 추가
                const input = document.createElement('input');
                input.type = 'hidden';
                input.name = 'scenario';
                input.value = scenario;
                form.appendChild(input);
            }

            form.submit();
        }

        function setNormalData() {
            document.getElementById('name').value = '정상캐릭터';
            document.getElementById('job').value = 'warrior';
            document.getElementById('level').value = '25';
            document.getElementById('health').value = '100';
            document.getElementById('mana').value = '50';
            document.querySelector('input[name="premium"]').checked = true;
            document.querySelector('input[name="gender"][value="male"]').checked = true;
            document.querySelector('input[name="skills"][value="attack"]').checked = true;
            document.querySelector('input[name="skills"][value="defense"]').checked = true;
        }

        function setErrorData1() {
            document.getElementById('name').value = '에러테스트캐릭터';
            document.getElementById('job').value = 'mage';
            document.getElementById('level').value = '이십오';
            document.getElementById('health').value = '체력많이';
            document.getElementById('mana').value = '마나무한';
        }

        function setErrorData2() {
            document.getElementById('name').value = '@#$%^&*()';
            document.getElementById('job').value = 'archer';
            document.getElementById('level').value = '!@#';
            document.getElementById('health').value = '****';
            document.getElementById('mana').value = '@@@@';
        }

        function setEmptyData() {
            document.getElementById('name').value = '';
            document.getElementById('job').value = '';
            document.getElementById('level').value = '';
            document.getElementById('health').value = '';
            document.getElementById('mana').value = '';
        }
    </script>
</body>
</html>

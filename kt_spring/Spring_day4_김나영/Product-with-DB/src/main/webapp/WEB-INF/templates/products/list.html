<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>상품 목록</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f5f5f5; margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #2c3e50; text-align: center; margin-bottom: 30px; }
        .btn { display: inline-block; padding: 8px 16px; text-decoration: none; border-radius: 4px; margin: 0 4px; color: white; border: none; cursor: pointer; }
        .btn-primary { background-color: #3498db; }
        .btn-info { background-color: #17a2b8; }
        .btn-warning { background-color: #f39c12; }
        .btn-danger { background-color: #e74c3c; }
        .btn-secondary { background-color: #6c757d; }
        .btn-success { background-color: #28a745; }
        .product-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        .product-table th, .product-table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        .product-table th { background-color: #34495e; color: white; }
        
        /* 검색 폼 스타일 */
        .search-form { background: #f8f9fa; padding: 20px; margin: 20px 0; border-radius: 8px; border: 1px solid #dee2e6; }
        .search-row { display: flex; gap: 15px; align-items: end; flex-wrap: wrap; }
        .search-group { display: flex; flex-direction: column; }
        .search-group label { margin-bottom: 5px; font-weight: bold; color: #495057; }
        .search-group input { padding: 8px 12px; border: 1px solid #ced4da; border-radius: 4px; font-size: 14px; }
        .search-group input:focus { outline: none; border-color: #3498db; }
        .price-range { display: flex; gap: 10px; align-items: center; }
        .price-range input { width: 120px; }
        .search-actions { display: flex; gap: 10px; }
        .result-info { margin: 15px 0; color: #6c757d; font-size: 14px; }
        .empty-message { text-align: center; padding: 40px; color: #6c757d; font-size: 16px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>상품 목록</h1>

        <!-- 검색 및 필터링 폼 -->
        <div class="search-form">
            <form th:action="@{/products}" method="get">
                <div class="search-row">
                    <div class="search-group">
                        <label for="name">상품명 검색</label>
                        <input type="text" id="name" name="name" th:value="${searchName}" 
                               placeholder="상품명을 입력하세요" style="width: 200px;">
                    </div>
                    
                    <div class="search-group">
                        <label>가격 범위</label>
                        <div class="price-range">
                            <input type="number" name="minPrice" th:value="${searchMinPrice}" 
                                   placeholder="최소 가격" min="0">
                            <span>~</span>
                            <input type="number" name="maxPrice" th:value="${searchMaxPrice}" 
                                   placeholder="최대 가격" min="0">
                            <span>원</span>
                        </div>
                    </div>
                    
                    <div class="search-actions">
                        <button type="submit" class="btn btn-success">검색</button>
                        <a th:href="@{/products}" class="btn btn-secondary">초기화</a>
                    </div>
                </div>
            </form>
        </div>

        <!-- 검색 결과 정보 -->
        <div class="result-info">
            <span th:if="${!searchName.isEmpty() or searchMinPrice != null or searchMaxPrice != null}">
                검색 조건: 
                <span th:if="${!searchName.isEmpty()}" th:text="'상품명: ' + ${searchName}"></span>
                <span th:if="${searchMinPrice != null}" th:text="'최소가격: ' + ${#numbers.formatInteger(searchMinPrice, 0, 'COMMA')} + '원'"></span>
                <span th:if="${searchMaxPrice != null}" th:text="'최대가격: ' + ${#numbers.formatInteger(searchMaxPrice, 0, 'COMMA')} + '원'"></span>
                | 
            </span>
            총 <span th:text="${#lists.size(products)}"></span>개의 상품이 있습니다.
        </div>

        <a th:href="@{/products/new}" class="btn btn-primary">새 상품 등록</a>

        <table class="product-table">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>상품명</th>
                    <th>가격</th>
                    <th>재고</th>
                    <th>액션</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="product : ${products}">
                    <td th:text="${product.id}"></td>
                    <td th:text="${product.name}"></td>
                    <td th:text="${#numbers.formatInteger(product.price, 0, 'COMMA')} + '원'"></td>
                    <td th:text="${product.stock}"></td>
                    <td>
                        <a th:href="@{/products/{id}(id=${product.id})}" class="btn btn-info">보기</a>
                        <a th:href="@{/products/{id}/edit(id=${product.id})}" class="btn btn-warning">수정</a>
                        <form th:action="@{/products/{id}(id=${product.id})}" method="post" style="display:inline;">
                            <input type="hidden" name="_method" value="delete">
                            <button type="submit" class="btn btn-danger" 
                                    onclick="return confirm('정말 삭제하시겠습니까?')">삭제</button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>

        <div th:if="${#lists.isEmpty(products)}" class="empty-message">
            <span th:if="${!searchName.isEmpty() or searchMinPrice != null or searchMaxPrice != null}">
                검색 조건에 맞는 상품이 없습니다.<br>
                <a th:href="@{/products}" class="btn btn-primary" style="margin-top: 10px;">전체 상품 보기</a>
            </span>
            <span th:unless="${!searchName.isEmpty() or searchMinPrice != null or searchMaxPrice != null}">
                등록된 상품이 없습니다.<br>
                <a th:href="@{/products/new}" class="btn btn-primary" style="margin-top: 10px;">첫 상품 등록하기</a>
            </span>
        </div>
    </div>
</body>
</html>
